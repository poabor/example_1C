# –ü–æ–∏—Å–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π Memory –≤ –ª–æ–≥–∞—Ö –¢–ñ 1–°

## –û–ø–∏—Å–∞–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ª–æ–≥–∏ 1–° (—Ñ–∞–π–ª—ã `.log` –≤ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö) –∏ –Ω–∞—Ö–æ–¥–∏—Ç –¢–û–ü-3 –∑–∞–ø–∏—Å–µ–π —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏ (–ø–æ–ª–µ `Memory`) –≤ —Å–æ–±—ã—Ç–∏—è—Ö CALL.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ª–æ–≥–æ–≤ –≤ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- ‚ö° –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö —è–¥–µ—Ä CPU (–∫—Ä–æ–º–µ 2)
- üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- üìù –ß–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Bash 4+
- GNU Parallel
- mawk (–±—ã—Å—Ç—Ä—ã–π awk)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã: grep, sort, find

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
sudo apt-get install parallel mawk
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ª–æ–≥–∞–º–∏
2. –°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
   ```bash
   chmod +x analyze_logs.sh
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   ./analyze_logs.sh
   ```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞
```
[2023-11-20 14:30:00] –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–æ–≤...
[14:30:05] –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω. –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å—Ç—Ä–æ–∫: 125478
[14:30:07] –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...

=== –¢–æ–ø-3 –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π Memory ===
–†–µ–π—Ç–∏–Ω–≥ | –ü–∞–º—è—Ç—å (MB) | –ü–∞–º—è—Ç—å (–±–∞–π—Ç—ã) | –§–∞–π–ª               | –°—Ç—Ä–æ–∫–∞ (–ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤)
------- | ----------- | -------------- | ------------------ | --------------------------
1      | 990.06      | 1038153608     | ./rphost_880902/... | 00:12.456001-3,CALL,1,process=rphost,p:processName=erp,OSThread=1705590...

=== –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ ===
–ú–µ—Å—Ç–æ 1:
–§–∞–π–ª:    ./rphost_880902/25040103.log
–ü–∞–º—è—Ç—å:  990.06 MB (1038153608 bytes)
–°—Ç—Ä–æ–∫–∞:  00:12.456001-3,CALL,1,process=rphost,p:processName=erp,OSThread=1705590...

=== –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ===
–û–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:    7.85 —Å–µ–∫—É–Ω–¥
–í—Ä–µ–º—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:    5.12 —Å–µ–∫—É–Ω–¥ (65%)
–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:         2.73 —Å–µ–∫—É–Ω–¥ (35%)
[2023-11-20 14:30:08] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

## –û–ø—Ü–∏–∏ (–º–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–∫—Ä–∏–ø—Ç–µ)
- `WORKER_JOBS` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —è–¥–µ—Ä CPU (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–ª–æ–≤–∏–Ω–∞ –æ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö)
- `head -3` - –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª—è –≤—ã–≤–æ–¥–∞ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `/tmp` –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—É—Ç–∏ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
–î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –ª–æ–≥–æ–≤ (10GB+):
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –±—É—Ñ–µ—Ä —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
export SORT_BUFFER_SIZE=4G
nice -n -20 ./find_max_memory.sh
```